"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const child_process_1 = require("child_process");
const buidler_params_1 = require("../core/params/buidler-params");
const env_variables_1 = require("../core/params/env-variables");
const ArgumentsParser_1 = require("./ArgumentsParser");
const nodeArgs = [...process.execArgv];
if (process.env.DISABLE_BUIDLEREVM_OPTIMIZATIONS === undefined) {
    nodeArgs.push("--max-semi-space-size=100");
}
const envVariableArguments = env_variables_1.getEnvBuidlerArguments(buidler_params_1.BUIDLER_PARAM_DEFINITIONS, process.env);
const argumentsParser = new ArgumentsParser_1.ArgumentsParser();
const { buidlerArguments } = argumentsParser.parseBuidlerArguments(buidler_params_1.BUIDLER_PARAM_DEFINITIONS, envVariableArguments, process.argv.slice(2));
if (buidlerArguments.maxMemory !== undefined) {
    nodeArgs.push(`--max-old-space-size=${buidlerArguments.maxMemory}`);
}
const childProcess = child_process_1.fork(`${__dirname}/cli`, process.argv.slice(2), {
    stdio: "inherit",
    execArgv: nodeArgs,
});
childProcess.once("close", (status) => {
    process.exit(status);
});
//# sourceMappingURL=bootstrap.js.map